{
  "version": "1.0",
  "parameters": {
    "dbPrefix": { "default": "" },
    "dbName": { "default": "${dbPrefix}projectdb" },
    "dbOwner": { "default": "${dbName}" },
    "dbManager": { "default": "${dbName}_manager" },
    "dbManagerPwd": { "default": "postgres" }
  },
  "databaseName": "${dbName}",
  "databaseOwner": "${dbOwner}",
  "transactions": [
    {
      "displayName": "Pre-deployment",
      "batches": [
        {
          "workdir": "pre-deployment",
          "fileDiscoveryMode": "matchOnly",
          "runOrder": [ "pre-deployment.sql" ]
        }
      ]
    },
    {
      "displayName": "Upgrade",
      "batches": [
        {
          "workdir": "migrations",
          "fileDiscoveryMode": "matchOnly",
          "customExec": "SELECT system.migration_script_execute(@json);",
          "runOrder": [
            "00-00-00.sql",
            "00-00-01.sql"
          ]
        },
        {
          "workdir": "setup",
          "fileDiscoveryMode": "deepDiscovery",
          "runOrder": [ "setup.sql" ]
        }
      ]
    },
    {
      "displayName": "Post-deployment",
      "batches": [
        {
          "workdir": "post-deployment",
          "fileDiscoveryMode": "deepDiscovery",
          "runOrder": [ "post-deployment.sql" ]
        }
      ]
    }
  ]
}
